var core = exports;

core.createIndex = function(index, options, client, logger) {
    client.createIndex(index, options)
        .on('data', function(data) {
            var jsonObject = JSON.parse(data);
            if (jsonObject.error) {
                logger.log('error', 'on-data', jsonObject);
                console.log('error: ' + JSON.stringify(jsonObject));
            }
        })
        .on('error', function(error) {
            logger.log('error', 'on-error', error);
            console.log('error: ' + JSON.stringify(error));
        })
        .exec()

    return;
};

core.putMapping = function(index, type, options, client, logger) {
    client.putMapping(index, type, options)
        .on('data', function(data) {
            var jsonObject = JSON.parse(data);
            if (jsonObject.ok != true) {
                logger.log('error', 'on-data', jsonObject);
            }
        })
        .on('error', function(error) {
            logger.log('error', 'on-error', error);
        })
        .exec();
}

core.createTemplate = function(templateName, options, client, logger) {
    client.defineTemplate(templateName, options)
        .on('data', function(data) {
            var jsonObject = JSON.parse(data);
            if (jsonObject.ok != true) {
                logger.log('error', 'on-data', jsonObject);
            }
        })
        .on('error', function(error) {
            logger.log('error', 'on-error', error);
        })
        .exec();
}

core.deleteMapping = function(index, type, client, logger, cb){
    client.deleteMapping(index, type, client, cb)
        .on('data', function(data) {
            var jsonObject = JSON.parse(data);
            if (jsonObject.ok != true) {
                logger.log('error', 'on-data', jsonObject);
            }
        })
        .on('error', function(error) {
            logger.log('error', 'on-error', error);
        })
        .exec();
}